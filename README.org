* Benj

Benj utility scripts

** R installation

Note that r-anndata must be installed for all unit tests to pass
#+BEGIN_SRC bash
## Install under current environment
make
#+END_SRC
** Python installation

#+BEGIN_SRC bash
pip install .
#+END_SRC
** Conda environments
Environments under [[conda/]] can be used. Mamba is recommended for environment creation because of the number of packages
*** rbenj
#+BEGIN_SRC bash
mamba env create --file=conda/rbenj.yml
R --slave -e 'devtools::install_github(c("GreenleafLab/ArchR", "lhe17/nebula"), ref="master", repos = BiocManager::repositories())'
make
#+END_SRC
*** pybenj
#+BEGIN_SRC bash
mamba env create --file=conda/pybenj.yml
pip install .
#+END_SRC
*** benj
#+BEGIN_SRC bash
mamba env create --file=conda/benj.yml
R --slave -e 'devtools::install_github(c("GreenleafLab/ArchR", "lhe17/nebula"), ref="master", repos = BiocManager::repositories())'
make
pip install .
#+END_SRC
* RNA integration/subtyping framework
#+BEGIN_SRC bash
  function integrate {
      cls=${1:-overall}
      shift
      integrate_rna.py -i concatenated.h5ad \
		       -o "${cls}/${cls}.h5ad" \
		       -t "${cls}/${cls}_clust.tsv.gz" \
		       -f "${cls}" \
		       -b "batch" \
		       -l "${cls}_clust" \
		       --hvg 5000 \
		       --dotplot Mbp Pdgfra Aif1 Gfap Flt1 Pdgfrb Syt1 Slc17a7 Gad1 \
		       "$@"
  }
  integrate overall
  integrate exc -a ./overall_clust/overall_clust.tsv.gz --subset overall_clust=C1,C2,C3 --plot overall_clust
  integrate exc_L23 -a ./exc_clust/exc_clust.tsv.gz --subset exc_clust=C0,C2,C3 --plot overall_clust exc_clust


#+END_SRC
* TODO Upgrades
1. heatmap legend size
2. repel
3. easy volcano plots
4. heatmap annotations
5. colorRamp2 log transform
6. easy manhattan plot
7. examples

* Datasets

| Link                                                                                                                                    | MD5sum                           |
|-----------------------------------------------------------------------------------------------------------------------------------------+----------------------------------|
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_filtered_feature_bc_matrix.h5 | df86844b99161b9487090d91e644745e |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz         | 7635e27373de5dabd5b54ad58a30bc61 |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz.tbi     | 134a3ca2dc01c398a2905504bd6384f7 |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_atac_peak_annotation.tsv      | 38f8abd2ba764e9693869e0111ad7a59 |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/human_brain_3k/human_brain_3k_filtered_feature_bc_matrix.h5                           | ba0b765eddb138d6d6294227879b9a9b |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/human_brain_3k/human_brain_3k_atac_fragments.tsv.gz                                   | b1594a4096405128e646e6a275e3ada3 |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/human_brain_3k/human_brain_3k_atac_fragments.tsv.gz.tbi                               | 3054c179689ff025f9e64df6d7a79040 |
| https://cf.10xgenomics.com/samples/cell-arc/2.0.0/human_brain_3k/human_brain_3k_atac_peak_annotation.tsv                                | 5c9cde0442444bbc2c4c57c577db6c80 |
